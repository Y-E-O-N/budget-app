# 수정완료사항 정리

> 최종 업데이트: 2026-01-21
> 총 31개 항목 중 31개 해결 (100%)

---

## 1. 모바일 환경에서 예산 등 입력시 키보드가 올라옴에 따라 버튼이 올라가서 겹쳐 보이는 현상 수정

| 항목 | 내용 |
|------|------|
| **문제점** | 모바일에서 텍스트 입력 시 소프트 키보드가 올라오면서 다이얼로그의 버튼이 입력 필드와 겹쳐 보임 |
| **해결 전략** | 다이얼로그 컨텐츠를 스크롤 가능하게 만들어 키보드가 올라와도 스크롤로 전체 UI 접근 가능하도록 함 |
| **해결 방법** | 모든 입력 다이얼로그의 content를 `SingleChildScrollView`로 감싸기 |
| **해결 파일** | `budget_tab.dart:425`, `budget_detail_screen.dart:592` |
| **해결 후 상황** | ✅ 키보드가 올라와도 스크롤하여 모든 UI 요소에 접근 가능 |

---

## 2. 예산명, 예산 금액, 사용금액, 잔여 금액별 정렬 기능 추가

| 항목 | 내용 |
|------|------|
| **문제점** | 예산 목록을 특정 기준으로 정렬할 수 없어 원하는 정보를 빠르게 찾기 어려움 |
| **해결 전략** | 각 열 헤더를 터치하면 해당 기준으로 정렬되도록 구현, 오름차순/내림차순 토글 지원 |
| **해결 방법** | `BudgetSortOption` enum 정의, 헤더 셀에 터치 이벤트 추가, 정렬 상태에 따라 화살표 아이콘 표시 |
| **해결 파일** | `budget_tab.dart:52, 64-97, 282-331` |
| **해결 후 상황** | ✅ 예산명/예산금액/사용금액/잔여금액 기준 정렬 가능, 활성 정렬은 파란색 화살표로 표시 |

---

## 3. 예산 순서(위치) 조정 기능

| 항목 | 내용 |
|------|------|
| **문제점** | 예산 항목의 순서를 사용자가 원하는 대로 변경할 수 없음 |
| **해결 전략** | 예산 항목 롱프레스 시 컨텍스트 메뉴에서 위로/아래로 이동 옵션 제공 |
| **해결 방법** | `moveBudgetUp()`, `moveBudgetDown()` 메서드 구현, 롱프레스 메뉴에 이동 옵션 추가 |
| **해결 파일** | `budget_tab.dart:561-572`, `budget_provider.dart` |
| **해결 후 상황** | ✅ 예산 항목 롱프레스 후 위로/아래로 이동하여 순서 조정 가능 |

---

## 4. 트렌드 탭에서 월별 지출추이 그래프에 '월'이 두번씩 표기되는 현상

| 항목 | 내용 |
|------|------|
| **문제점** | X축 라벨에 '1월', '2월' 등이 중복으로 두 번씩 표시됨 |
| **해결 전략** | X축 라벨 생성 시 정수 인덱스만 표시하도록 조건 추가 |
| **해결 방법** | `getTitlesWidget`에서 `value == value.toInt()` 조건으로 정수 값만 라벨 표시 |
| **해결 파일** | `stats_tab.dart:539-543` |
| **해결 후 상황** | ✅ X축에 월 라벨이 한 번만 표시됨 |

---

## 5. 트렌드 탭 월별 지출 추이에서 데이터가 없으면 '-' 표시

| 항목 | 내용 |
|------|------|
| **문제점** | 해당 월에 지출 데이터가 없을 때 빈 값으로 표시되어 혼란 유발 |
| **해결 전략** | 데이터가 0이거나 없을 때 '-' 문자로 표시 |
| **해결 방법** | 삼항 연산자 `d.expense > 0 ? FormatUtils.formatAmountShort(d.expense) : '-'` 적용 |
| **해결 파일** | `stats_tab.dart:493` |
| **해결 후 상황** | ✅ 데이터 없는 월은 '-'로 명확히 표시 |

---

## 6. 예산 탭에서 각 예산별로 가장 우측의 '>'를 지우고, 그만큼 예산명 너비를 늘린다

| 항목 | 내용 |
|------|------|
| **문제점** | 불필요한 '>' 화살표가 공간을 차지하여 예산명이 잘려 보임 |
| **해결 전략** | 화살표 열 제거 후 예산명 열의 너비를 확대 |
| **해결 방법** | 5열에서 4열 구조로 변경, 예산명에 `FlexColumnWidth(3)` 적용 |
| **해결 파일** | `budget_tab.dart:212-217, 490-495` |
| **해결 후 상황** | ✅ 화살표 제거, 예산명이 더 넓은 공간에 표시됨 |

---

## 7. 예산탭에서 반복되는 예산명 옆에 나타나는 표시 화살표 마크 삭제

| 항목 | 내용 |
|------|------|
| **문제점** | 반복 예산을 나타내는 화살표 아이콘이 UI를 복잡하게 만듦 |
| **해결 전략** | 반복 예산 표시 아이콘 완전 제거 |
| **해결 방법** | `if (budget.isRecurring) Icon(...)` 조건부 렌더링 코드 삭제 |
| **해결 파일** | `budget_tab.dart:502-513` |
| **해결 후 상황** | ✅ 반복 예산 아이콘 제거로 UI 간소화 |

---

## 8. 예산탭에서 '예산', '사용', '남음' 등은 중앙정렬로 수정

| 항목 | 내용 |
|------|------|
| **문제점** | 헤더 텍스트가 좌측 정렬되어 있어 데이터와 정렬이 맞지 않음 |
| **해결 전략** | 모든 헤더 셀에 중앙 정렬 적용 |
| **해결 방법** | 헤더 셀에 `align: TextAlign.center` 속성 추가 |
| **해결 파일** | `budget_tab.dart:222-225, 515-524` |
| **해결 후 상황** | ✅ 헤더와 데이터가 중앙 정렬로 통일 |

---

## 9. 예산탭 상단 날짜를 '2026.2' 형식에서 '2026년 2월' 형식으로 수정

| 항목 | 내용 |
|------|------|
| **문제점** | '2026.2' 형식이 직관적이지 않고 한국어 사용자에게 어색함 |
| **해결 전략** | 한국어 날짜 형식으로 변경 |
| **해결 방법** | `'${provider.currentYear}년 ${provider.currentMonth}월'` 형식으로 수정 |
| **해결 파일** | `budget_tab.dart:120` |
| **해결 후 상황** | ✅ '2026년 2월' 형식으로 가독성 향상 |

---

## 10. 예산탭에서 날짜를 터치하면 달력 등이 나와서 연도와 월을 쉽게 선택하도록 수정

| 항목 | 내용 |
|------|------|
| **문제점** | 월 이동이 좌우 화살표로만 가능하여 먼 월로 이동 시 불편 |
| **해결 전략** | 날짜 터치 시 연도/월 선택 다이얼로그 표시 |
| **해결 방법** | 날짜를 `InkWell`로 감싸고, `_showMonthPickerDialog()` 구현 (연도 좌우 이동 + 월 그리드) |
| **해결 파일** | `budget_tab.dart:116-122, 334-411` |
| **해결 후 상황** | ✅ 날짜 터치 시 월 선택 다이얼로그로 빠른 이동 가능 |

---

## 11. 내역 검색할 때, 이미 삭제한 예산명이 뜨거나 이번달에는 없는 예산 명이 떠서 복잡해보임

| 항목 | 내용 |
|------|------|
| **문제점** | 예산 필터 드롭다운에 삭제된 예산이나 현재 월에 없는 예산이 표시되어 혼란 |
| **해결 전략** | 예산/세부예산 필터 기능 자체를 제거하여 단순화 (11-1 방안 채택) |
| **해결 방법** | 예산/세부예산 필터 드롭다운 완전 제거, 기간 필터만 유지 |
| **해결 파일** | `history_tab.dart:63, 79, 96, 174` |
| **해결 후 상황** | ✅ 내역 검색 UI 단순화, 혼란 요소 제거 |

---

## 12. 통계탭에서 상단 형식을 예산 탭과 동일하게 '2026년 2월' 형식으로 변경하고 월별로 넘길 수 있게 수정

| 항목 | 내용 |
|------|------|
| **문제점** | 통계탭의 날짜 형식이 예산탭과 다르고, 월 이동 기능 없음 |
| **해결 전략** | 예산탭과 동일한 UI 패턴 적용 |
| **해결 방법** | 날짜 형식 '2026년 2월'로 변경, 좌우 화살표 버튼으로 월 이동 기능 추가 |
| **해결 파일** | `stats_tab.dart:70-91` |
| **해결 후 상황** | ✅ 예산탭과 통일된 날짜 UI, 월 이동 가능 |

---

## 13. LLM 분석시, 예산 금액과 현재까지 사용금액을 볼때 잔여 기간동안의 지출 계획 조언을 추가

| 항목 | 내용 |
|------|------|
| **문제점** | AI 분석 결과에 남은 기간 동안의 구체적인 지출 계획 조언이 없음 |
| **해결 전략** | AI 응답에 잔여 기간 지출 계획 필드 추가 |
| **해결 방법** | 응답에 `spendingPlan` 필드 추가, FastAPI 프롬프트에서 "남은 X일간 하루 평균 XXX원" 형식 생성 |
| **해결 파일** | `ai_analysis_service.dart:25, 49, 62`, `budget_api/main.py:209, 320-325` |
| **해결 후 상황** | ✅ AI 분석 결과에 잔여 기간별 지출 계획 조언 포함 |

---

## 14. 지출 내역 '복제'버튼을 눌렀는데 실제로는 복제가 안됨

| 항목 | 내용 |
|------|------|
| **문제점** | 복제 버튼 클릭 시 아무 동작도 하지 않음 |
| **해결 전략** | 복제 시 원본 데이터가 채워진 수정 다이얼로그 표시 |
| **해결 방법** | 복제 버튼 클릭 시 날짜/메모/금액 수정 가능한 다이얼로그 표시 후 저장 |
| **해결 파일** | `budget_detail_screen.dart:560-634` |
| **해결 후 상황** | ✅ 복제 후 날짜만 수정하여 새 지출 등록 가능 |

---

## 15. 예산 선택 후 화면에서도 월 변경 가능하도록

| 항목 | 내용 |
|------|------|
| **문제점** | 예산 상세 화면에서 월 이동이 불가능하여 매번 뒤로 가야 함 |
| **해결 전략** | AppBar에 월 이동 버튼 추가 |
| **해결 방법** | 예산 상세 화면 AppBar에 좌우 화살표 버튼 추가 |
| **해결 파일** | `budget_detail_screen.dart:68-87` |
| **해결 후 상황** | ✅ 예산 상세 화면에서 직접 월 변경 가능 |

---

## 16. 시작요일 설정 기능 숨김

| 항목 | 내용 |
|------|------|
| **문제점** | 시작요일 설정 기능이 현재 필요하지 않아 UI를 복잡하게 만듦 |
| **해결 전략** | 해당 설정 UI 숨김 처리 |
| **해결 방법** | `_buildStartDayRow()` 호출 코드 주석 처리 |
| **해결 파일** | `settings_tab.dart:54` |
| **해결 후 상황** | ✅ 설정 화면 단순화 |

---

## 17. AI 분석기능을 FastAPI로 분리, 일일 3회 제한

| 항목 | 내용 |
|------|------|
| **문제점** | AI 분석이 클라이언트에서 직접 처리되어 API 키 노출 위험, 사용량 제한 없음 |
| **해결 전략** | FastAPI 백엔드로 분리, device_id 기반 일일 사용량 제한 |
| **해결 방법** | FastAPI 백엔드 구현, device_id 기반 KST 기준 일일 3회 제한, 사용량 조회 API 추가 |
| **해결 파일** | `budget_api/main.py:43, 349-387, 362-527`, `ai_analysis_service.dart:306`, `database.py` |
| **해결 후 상황** | ✅ 백엔드에서 AI 분석 처리, 일일 3회 제한 적용 |

---

## 18. 예산 탭에서 월 변경시, 변경된 월의 해당 예산 탭이 표시되어야함

| 항목 | 내용 |
|------|------|
| **문제점** | 월 변경 후에도 이전 월의 예산 데이터가 표시됨 |
| **해결 전략** | 월 선택 시 자동으로 해당 월 데이터 로드 |
| **해결 방법** | 월 선택 다이얼로그 확인 시 `setYearMonth` 메서드로 데이터 갱신 |
| **해결 파일** | `budget_tab.dart:18`, `budget_provider.dart` |
| **해결 후 상황** | ✅ 월 변경 시 해당 월의 예산 데이터 즉시 표시 |

---

## 19. '예산', '사용', '남음', '예산명' 등 모든 열의 제목은 중앙 정렬

| 항목 | 내용 |
|------|------|
| **문제점** | 일부 열 제목이 좌측/우측 정렬되어 일관성 없음 |
| **해결 전략** | 모든 탭의 모든 헤더 셀에 중앙 정렬 적용 |
| **해결 방법** | 예산탭, 내역탭, 통계탭의 모든 헤더에 `TextAlign.center` 적용 |
| **해결 파일** | `budget_tab.dart:173-175, 222-225`, `history_tab.dart:256-259`, `stats_tab.dart:174-176, 260-263` |
| **해결 후 상황** | ✅ 전체 앱에서 헤더 중앙 정렬 통일 |

---

## 20. 내역탭에서 날짜 열의 너비를 딱 맞도록 줄이고, 예산 항목 너비 늘림

| 항목 | 내용 |
|------|------|
| **문제점** | 날짜 열이 불필요하게 넓어 예산 항목명이 잘림 |
| **해결 전략** | 날짜 열 너비 고정, 예산 항목 열 너비 확대 |
| **해결 방법** | 날짜 `FixedColumnWidth(60)`, 카테고리 `FlexColumnWidth(2)` 적용 |
| **해결 파일** | `history_tab.dart:248-251, 580-583` |
| **해결 후 상황** | ✅ 날짜 열 최소화, 예산 항목 가독성 향상 |

---

## 21. 내역 탭의 날짜를 중앙 정렬

| 항목 | 내용 |
|------|------|
| **문제점** | 날짜가 좌측 정렬되어 다른 열과 정렬 불일치 |
| **해결 전략** | 날짜 열 중앙 정렬 적용 |
| **해결 방법** | 날짜 셀에 `align: TextAlign.center` 적용 |
| **해결 파일** | `history_tab.dart:256, 592` |
| **해결 후 상황** | ✅ 날짜 열 중앙 정렬로 정렬 통일 |

---

## 22. 통계탭의 비율 열 너비 조정

| 항목 | 내용 |
|------|------|
| **문제점** | 비율 열이 불필요하게 넓어 다른 열 공간 부족 |
| **해결 전략** | 비율 열 너비 축소 |
| **해결 방법** | 비율 열에 `FlexColumnWidth(0.8)` 적용 |
| **해결 파일** | `stats_tab.dart:168, 191, 211, 254, 283, 316` |
| **해결 후 상황** | ✅ 비율 열 최소화로 공간 효율성 향상 |

---

## 23. 통계 탭의 트렌드 페이지의 그래프의 X축에서 숫자가 두번씩 나타나는 걸 한번만 나타나도록 수정

| 항목 | 내용 |
|------|------|
| **문제점** | X축에 월 숫자가 중복 표시됨 (예: 1, 1, 2, 2...) |
| **해결 전략** | X축 라벨 간격 조정 및 정수 조건 추가 |
| **해결 방법** | interval을 1로 설정, 정수 인덱스만 표시하는 조건 추가 |
| **해결 파일** | `stats_tab.dart:539-543` |
| **해결 후 상황** | ✅ X축에 월 숫자 한 번만 표시 |

---

## 24. 통계 탭의 트렌드 페이지의 그래프는 점과 점을 직선으로 연결할 것

| 항목 | 내용 |
|------|------|
| **문제점** | 그래프가 곡선으로 연결되어 실제 데이터 추이 파악이 어려움 |
| **해결 전략** | 곡선 대신 직선 연결로 변경 |
| **해결 방법** | `LineChartBarData`에 `isCurved: false` 설정 |
| **해결 파일** | `stats_tab.dart:567` |
| **해결 후 상황** | ✅ 데이터 포인트가 직선으로 연결되어 추이 파악 용이 |

---

## 25. 예산별 지출내역은 기본으로 날짜 오름차순 정렬하고, 터치해서 정렬 순서를 바꿀 수 있도록 할 것

| 항목 | 내용 |
|------|------|
| **문제점** | 지출 내역 정렬 기능 없음, 기본 정렬 순서 불명확 |
| **해결 전략** | 날짜 기준 기본 오름차순 정렬, 헤더 터치로 정렬 방향 전환 |
| **해결 방법** | `ExpenseSortOption` enum 정의, 날짜 헤더에 터치 이벤트로 정렬 방향 토글 |
| **해결 파일** | `budget_detail_screen.dart:26-53, 159-176` |
| **해결 후 상황** | ✅ 기본 날짜 오름차순 정렬, 터치로 내림차순 전환 가능 |

---

## 26. AI 분석 결과를 좀 더 큰 화면에서 보여주거나 새로운 탭 또는 페이지로 보여주는 게 좋을 듯

| 항목 | 내용 |
|------|------|
| **문제점** | AI 분석 결과가 작은 다이얼로그에 표시되어 가독성 떨어짐 |
| **해결 전략** | 전용 전체 화면 페이지로 분리 |
| **해결 방법** | `AnalysisResultScreen` 신규 페이지 생성, 다이얼로그 대신 `Navigator.push()`로 이동 |
| **해결 파일** | `analysis_result_screen.dart` (신규), `stats_tab.dart:956-960` |
| **해결 후 상황** | ✅ AI 분석 결과 전체 화면에서 편하게 확인 가능 |

---

## 27. AI 분석 결과를 이미지(png) 형태로 내보내기 기능 추가

| 항목 | 내용 |
|------|------|
| **문제점** | AI 분석 결과를 저장하거나 공유할 방법이 없음 |
| **해결 전략** | 화면 캡처 후 이미지로 공유 기능 구현 |
| **해결 방법** | `RepaintBoundary`로 위젯 감싸고 이미지 캡처, `share_plus` 패키지로 공유 |
| **해결 파일** | `analysis_result_screen.dart:32, 52-59, 64-65, 303-345` |
| **해결 후 상황** | ✅ AI 분석 결과를 PNG 이미지로 내보내기/공유 가능 |

---

## 28. '정기지출' 예산의 세부 내역이 실제로 고정 지출임에도 AI 분석 결과에서는 이를 일회성 소비로 파악함

| 항목 | 내용 |
|------|------|
| **문제점** | AI가 정기지출/고정지출 예산의 항목을 일회성 소비로 잘못 분류 |
| **해결 전략** | 예산명 키워드 기반으로 고정지출 여부 판단하여 AI에 전달 |
| **해결 방법** | `_isFixedExpenseBudget()` 헬퍼로 예산명 키워드('정기', '고정', '월세' 등) 감지, AI 데이터에 유형 정보 포함 |
| **해결 파일** | `markdown_export_service.dart` |
| **해결 후 상황** | ✅ AI가 정기지출 예산 항목을 고정지출로 인식 |

---

## 29. AI 분석하기 누르면, 오늘의 잔여횟수를 보여주고 진짜로 요청할 건지 확인하는 창을 보여줄 것

| 항목 | 내용 |
|------|------|
| **문제점** | AI 분석 버튼 클릭 즉시 요청되어 실수로 횟수 낭비 가능 |
| **해결 전략** | 분석 전 확인 다이얼로그 표시, 잔여 횟수 안내 |
| **해결 방법** | `_showAnalysisConfirmDialog()` 구현, 사용량 API 조회 후 잔여 횟수 표시, 0회면 버튼 비활성화 |
| **해결 파일** | `stats_tab.dart:860-948` |
| **해결 후 상황** | ✅ 분석 전 잔여 횟수 확인 및 요청 확인 가능 |

---

## 30. AI 분석하기 누르고 뜨는 현황 알림(네트워크 오류, 요청중 등)은 통계 탭 가장 하단에 표시할 것

| 항목 | 내용 |
|------|------|
| **문제점** | AI 분석 상태 알림이 화면 중앙에 표시되어 다른 정보 가림 |
| **해결 전략** | 상태 알림을 통계 탭 하단에 배치 |
| **해결 방법** | `_buildAnalysisStatusBanner()` 메서드를 현황 탭 컬럼 하단에 배치 |
| **해결 파일** | `stats_tab.dart:137, 590-653` |
| **해결 후 상황** | ✅ 분석 상태 알림이 하단에 표시되어 다른 정보 가리지 않음 |

---

## 31. 모바일웹에서 AI 분석 결과 내보내기 시도하는 경우 '내보내기 실패'라고 뜸

| 항목 | 내용 |
|------|------|
| **문제점** | Flutter Web 환경에서 `share_plus` 패키지의 파일 공유 기능이 정상 동작하지 않음 |
| **해결 전략** | 플랫폼별 조건부 import로 웹/네이티브 분기 처리, 웹에서는 브라우저 다운로드 사용 |
| **해결 방법** | `image_saver_stub.dart`, `image_saver_web.dart`, `image_saver_io.dart` 3개 파일로 플랫폼별 구현 분리. 웹에서는 `dart:html`의 `Blob` + `AnchorElement`로 다운로드, 네이티브에서는 기존 `share_plus` 사용 |
| **해결 파일** | `lib/utils/image_saver_stub.dart`, `lib/utils/image_saver_web.dart`, `lib/utils/image_saver_io.dart`, `analysis_result_screen.dart:304-354` |
| **해결 후 상황** | ✅ 웹에서는 이미지 다운로드, 네이티브에서는 공유 기능 정상 동작 |

---

## 요약

| 상태 | 개수 | 비율 |
|------|------|------|
| ✅ 해결됨 | 31개 | 100% |
| **총계** | **31개** | **100%** |

### 전체 완료
모든 수정 필요사항이 해결되었습니다.
